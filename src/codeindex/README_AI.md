<!-- Generated by codeindex at 2026-01-23T16:13:59+08:00 -->

# README_AI.md - codeindex

## Purpose
AI-native code indexing tool that automatically generates README_AI.md files for directories using external LLM CLI tools.

## Architecture
The tool follows a pipeline architecture where directories are scanned, parsed, formatted into prompts, and sent to external AI CLI tools for documentation generation. It supports incremental updates, parallel processing, and hierarchical organization with two-phase AI enhancement.

Data Flow:
```
Directory (Scanner) → Files (Scanner) → Parsed Data (Parser) → 
Prompt (Writer) → AI CLI (Invoker) → README_AI.md (Writer)
```

## Key Components

### Core Classes

| Component | Role |
|-----------|------|
| `Config` | Central configuration loader handling `.codeindex.yaml` settings |
| `Scanner` | Directory traversal and file filtering based on include/exclude patterns |
| `Parser` | Multi-language AST parser extracting symbols, imports, and docstrings |
| `Writer` | Formats parsed data into markdown README files |
| `AIEnhancementConfig` | Controls AI enhancement strategy and rate limiting |

### Command Pipeline

| Function | Command | Description |
|----------|---------|-------------|
| `scan` | `codeindex scan <path>` | Scan single directory and generate README |
| `scan-all` | `codeindex scan-all [--ai-all]` | Process all directories with two-phase strategy |
| `status` | `codeindex status` | Show indexing coverage and statistics |

### Smart Features

| Feature | Implementation |
|---------|----------------|
| Two-Phase Processing | Phase 1: SmartWriter parallel generation; Phase 2: AI enhancement with rate limiting |
| AI Enhancement Strategies | Selective (overview + oversize) or all directories with `--ai-all` |
| Incremental Updates | Git change analysis via `incremental.py` |
| Parallel Processing | Batch processing with worker pools |
| Hierarchical Levels | Smart content generation based on directory depth |
| Framework Detection | Pattern recognition for PHP/ThinkPHP projects |

## Consumes

| Module | Purpose |
|--------|---------|
| tree_sitter | Multi-language AST parsing |
| click | CLI interface and command handling |
| yaml | Configuration file parsing |
| rich | Terminal output formatting |
| git | Version control integration for incremental updates |

## Provides

| Export | Usage |
|--------|-------|
| CLI Commands | `codeindex scan`, `scan-all`, `status`, `symbols` |
| README Generation | Automated documentation for code directories |
| Symbol Indexing | Global symbol cross-reference (`PROJECT_SYMBOLS.md`) |
| Incremental Updates | Smart regeneration based on changes |
| AI Enhancement | Configurable AI enhancement with rate limiting |
