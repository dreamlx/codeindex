<!-- Generated by codeindex at 2026-02-02T14:06:14+08:00 -->

# tests

## Overview

- **Files**: 26
- **Symbols**: 483

## Files

### __init__.py

### conftest.py
_Shared test fixtures and utilities for codeindex tests._

**Functions:**
- `def create_mock_symbol(
    name: str = "test_function",
    kind: str = "function",
    signature: str = "def test_function():",
    docstring: str = "A test function",
    line_start: int = 1,
    line_end: int = 10,
) -> Symbol`
- `def create_mock_parse_result(
    file_path: str = "test.php",
    file_lines: int = 300,
    symbol_count: int = 15,
    class_name: str | None = None,
    methods_per_class: int = 0,
) -> ParseResult`
- `def mock_config()`
- `def symbol_scorer(mock_config)`

### test_adaptive_config.py
_Tests for adaptive symbols configuration._

**class** `class TestAdaptiveSymbolsConfig`
> Test AdaptiveSymbolsConfig data class.

**class** `class TestConfigurationValidation`
> Test configuration validation logic.

**Methods:**
- `def test_default_config_exists(self)`
- `def test_default_config_disabled_by_default(self)`
- `def test_default_config_has_thresholds(self)`
- `def test_default_config_has_limits(self)`
- `def test_default_thresholds_are_increasing(self)`
- `def test_default_limits_are_increasing(self)`
- `def test_default_min_max_symbols(self)`
- `def test_custom_config_initialization(self)`
- `def test_config_with_partial_overrides(self)`
- `def test_thresholds_should_be_positive(self)`
- `def test_limits_should_be_positive(self)`
- `def test_min_symbols_should_be_positive(self)`
- `def test_max_symbols_should_be_reasonable(self)`

_... and 6 more symbols_

### test_adaptive_selector.py
_Tests for AdaptiveSymbolSelector._

**class** `class TestAdaptiveSymbolSelectorBase`
> Test basic AdaptiveSymbolSelector functionality.

**class** `class TestSizeCategoryDetermination`
> Test file size category determination.

**Methods:**
- `def test_selector_initialization_with_default_config(self)`
- `def test_selector_initialization_with_custom_config(self)`
- `def test_calculate_limit_returns_int(self)`
- `def test_calculate_limit_returns_positive(self)`
- `def test_calculate_limit_not_exceed_total_symbols(self)`
- `def test_tiny_file_category(self)`
- `def test_tiny_boundary_99_lines(self)`
- `def test_small_file_category(self)`
- `def test_medium_file_category(self)`
- `def test_large_file_category(self)`
- `def test_xlarge_file_category(self)`
- `def test_huge_file_category(self)`
- `def test_mega_file_category(self)`

_... and 22 more symbols_

### test_ai_helper.py
_Unit tests for AI enhancement helper functions (Epic 4 Story 4.1)._

**Functions:**
- `def test_aggregate_multiple_parse_results()`
- `def test_aggregate_single_parse_result()`
- `def test_aggregate_empty_parse_results()`
- `def test_aggregate_preserves_symbol_order()`
- `def test_execute_multi_turn_with_auto_detection_super_large()`
- `def test_execute_multi_turn_with_explicit_strategy()`
- `def test_execute_multi_turn_with_standard_strategy_should_fail()`
- `def test_execute_multi_turn_with_multi_turn_failure()`

### test_cli_tech_debt.py
_Integration tests for tech-debt CLI command._

**class** `class TestTechDebtCommand`
> Test tech-debt CLI command.

**class** `class TestTechDebtIntegration`
> Integration tests for full tech-debt workflow.

**Methods:**
- `def test_tech_debt_command_exists(self)`
- `def test_analyze_directory_console_format(self, sample_files)`
- `def test_analyze_directory_markdown_format(self, sample_files)`
- `def test_analyze_directory_json_format(self, sample_files)`
- `def test_write_output_to_file(self, sample_files, tmp_path)`
- `def test_invalid_format_option(self, sample_files)`
- `def test_nonexistent_directory(self)`
- `def test_empty_directory(self, tmp_path)`
- `def test_recursive_option(self, tmp_path)`
- `def test_detect_multiple_issues(self, tmp_path)`
- `def test_report_quality_scores(self, sample_files)`
- `def test_console_output_has_colors(self, sample_files)`

**Functions:**
- `def sample_files(tmp_path)`

### test_config_adaptive.py
_Tests for adaptive symbols configuration loading in Config._

**class** `class TestSymbolsConfigAdaptive`
> Test SymbolsConfig with adaptive_symbols field.

**class** `class TestConfigLoadingAdaptive`
> Test Config loading with adaptive_symbols configuration.

**class** `class TestConfigurationMerging`
> Test configuration merging logic (user + defaults).

**class** `class TestBackwardCompatibility`
> Test backward compatibility with existing configs.

**Methods:**
- `def test_symbols_config_has_adaptive_field(self)`
- `def test_symbols_config_default_adaptive_disabled(self)`
- `def test_symbols_config_uses_default_adaptive_config(self)`
- `def test_load_config_without_adaptive(self)`
- `def test_load_config_with_adaptive_enabled(self)`
- `def test_load_config_with_custom_thresholds(self)`
- `def test_load_config_with_custom_limits(self)`
- `def test_load_config_with_partial_overrides(self)`
- `def test_load_config_with_min_max_symbols(self)`
- `def test_merge_preserves_user_thresholds(self)`
- `def test_merge_preserves_user_limits(self)`

_... and 2 more symbols_

### test_directory_tree.py
_Tests for the directory tree module._

**Functions:**
- `def _create_test_structure(base: Path)`
- `def test_directory_tree_build()`
- `def test_directory_tree_levels()`
- `def test_directory_tree_children()`
- `def test_directory_tree_processing_order()`
- `def test_directory_tree_empty()`
- `def test_directory_tree_deep_nesting()`

### test_file_classifier.py
_Unit tests for file size classifier (Epic 4 Story 4.2)._

**Functions:**
- `def test_classify_tiny_file()`
- `def test_classify_small_file()`
- `def test_classify_medium_file()`
- `def test_classify_large_file()`
- `def test_classify_super_large_by_lines()`
- `def test_classify_super_large_by_symbols()`
- `def test_classify_super_large_by_both()`
- `def test_is_super_large_convenience_method()`
- `def test_is_large_convenience_method()`
- `def test_custom_thresholds()`
- `def test_edge_case_exactly_at_threshold()`
- `def test_edge_case_just_over_threshold()`

### test_multi_turn_dialogue_bdd.py
_BDD tests for multi-turn dialogue enhancement (Epic 3.2 Story 3.2.2)._

**Functions:**
- `def load_config()`
- `def ai_cli_available()`
- `def super_large_file_with_specs(language, lines, symbols)`
- `def super_large_file_with_filename(filename)`
- `def file_with_statistics()`
- `def file_has_top_symbols()`
- `def round1_output_available()`
- `def symbols_grouped()`
- `def round1_completed()`
- `def grouped_symbols_available()`
- `def rounds_output_available()`
- `def complete_symbols_available()`
- `def rounds_completed()`
- `def file_being_processed()`
- `def round_timeout_configured(timeout)`

_... and 60 more symbols_

### test_parser.py
_Tests for the Python parser._

**Functions:**
- `def test_parse_simple_function()`
- `def test_parse_class_with_methods()`
- `def test_parse_imports()`
- `def test_parse_module_docstring()`
- `def test_parse_nonexistent_file()`
- `def test_parse_php_class_with_inheritance()`
- `def test_parse_php_method_visibility()`
- `def test_parse_php_properties()`
- `def test_parse_php_function()`
- `def test_parse_php_namespace()`
- `def test_parse_php_use_statements()`
- `def test_parse_php_group_use()`

### test_project_index_semantic.py
_Tests for PROJECT_INDEX.md semantic enhancement (TDD: RED phase)

Story 4.4: Business Semantic Extraction
Task 4.4.3: PROJECT_INDEX enhancement with s_

**class** `class TestExtractModulePurpose`
> Test extract_module_purpose function

**class** `class TestProjectIndexGeneration`
> Test full PROJECT_INDEX.md generation with semantic descriptions

**class** `class TestBDDProjectIndex`
> BDD-style tests for PROJECT_INDEX enhancement

**Methods:**
- `def test_extract_purpose_with_semantic(self, temp_project)`
- `def test_extract_purpose_without_semantic(self, temp_project)`
- `def test_extract_purpose_from_readme_fallback(self, temp_project)`
- `def test_project_index_with_semantic(self, temp_project)`
- `def test_scenario_php_project_index_quality(self, temp_project)`

**Functions:**
- `def temp_project(tmp_path)`

### test_route_info.py
_Tests for RouteInfo data structure (Epic 6, P1: Line Numbers)._

**class** `class TestRouteInfoLineNumber`
> Test RouteInfo with line number support.

**Methods:**
- `def test_route_info_with_line_number(self)`
- `def test_route_info_with_description(self)`
- `def test_route_info_location_with_line_number(self)`
- `def test_route_info_location_without_line_number(self)`
- `def test_route_info_location_no_file_path(self)`
- `def test_route_info_defaults(self)`
- `def test_route_info_all_fields(self)`

### test_semantic_extractor.py
_Tests for SemanticExtractor (TDD: RED phase)

Story 4.4: Business Semantic Extraction
Task 4.4.1: Create SemanticExtractor foundation_

**class** `class TestDirectoryContext`
> Test DirectoryContext data structure

**class** `class TestBusinessSemantic`
> Test BusinessSemantic data structure

**class** `class TestSemanticExtractor`
> Test SemanticExtractor functionality

**class** `class TestSemanticExtractorWithAI`
> Test SemanticExtractor with AI mode

**Methods:**
- `def test_directory_context_creation(self)`
- `def test_business_semantic_creation(self)`
- `def test_extractor_creation(self, extractor)`
- `def test_extractor_creation_with_ai_requires_command(self)`
- `def test_extractor_creation_with_ai_and_command(self)`
- `def test_extract_controller_semantic_heuristic(self, extractor)`
- `def test_extract_model_semantic_heuristic(self, extractor)`
- `def test_extract_generic_directory_semantic(self, extractor)`
- `def test_infer_from_symbols(self, extractor)`
- `def test_empty_context_handling(self, extractor)`
- `def test_build_ai_prompt(self, ai_extractor)`

_... and 6 more symbols_

### test_smart_writer.py
_Tests for the smart writer module._

**Functions:**
- `def _create_mock_parse_result(
    filename: str,
    symbols: list[Symbol] = None,
    imports: list[Import] = None,
    file_lines: int = 100,
) -> ParseResult`
- `def test_smart_writer_overview_level()`
- `def test_smart_writer_navigation_level()`
- `def test_smart_writer_detailed_level()`
- `def test_smart_writer_grouping()`
- `def test_smart_writer_symbol_filtering()`
- `def test_smart_writer_size_limit()`
- `def test_determine_level()`

### test_smart_writer_adaptive.py
_Tests for SmartWriter with adaptive symbol selection._

**class** `class TestSmartWriterAdaptiveDisabled`
> Test SmartWriter with adaptive disabled (backward compatibility).

**class** `class TestSmartWriterAdaptiveEnabled`
> Test SmartWriter with adaptive enabled.

**class** `class TestRealWorldScenarios`
> Test with real-world file scenarios.

**class** `class TestMultipleFiles`
> Test with multiple files of different sizes.

**class** `class TestFileLinesCounting`
> Test file lines counting mechanism.

**Methods:**
- `def test_uses_max_per_file_when_adaptive_disabled(self)`
- `def test_uses_adaptive_limit_for_small_file(self)`
- `def test_uses_adaptive_limit_for_large_file(self)`
- `def test_respects_total_symbols_constraint(self)`
- `def test_php_8891_lines_57_symbols(self)`
- `def test_php_500_lines_80_symbols(self)`
- `def test_mixed_file_sizes(self)`
- `def test_file_lines_from_parse_result(self)`

**Functions:**
- `def _create_mock_symbols(count: int) -> list[Symbol]`
- `def _create_mock_parse_result(path: Path, symbol_count: int, file_lines: int) -> ParseResult`

### test_smart_writer_semantic.py
_Tests for SmartWriter semantic extraction integration (TDD: RED phase)

Story 4.4: Business Semantic Extraction
Task 4.4.2: Integrate SemanticExtracto_

**class** `class TestSemanticConfig`
> Test SemanticConfig data structure

**class** `class TestSmartWriterSemanticIntegration`
> Test SmartWriter with semantic extraction

**class** `class TestBDDSemanticIntegration`
> BDD-style tests for semantic integration user stories

**Methods:**
- `def test_semantic_config_creation(self)`
- `def test_semantic_config_with_ai_mode(self)`
- `def test_smart_writer_with_semantic_enabled(self, indexing_config_with_semantic)`
- `def test_smart_writer_without_semantic(self, indexing_config_without_semantic)`
- `def test_extract_module_description_with_semantic(
        self,
        temp_dir,
        indexing_config_with_semantic
    )`
- `def test_extract_module_description_fallback(
        self,
        temp_dir,
        indexing_config_with_semantic
    )`
- `def test_semantic_extraction_with_empty_directory(
        self,
        temp_dir,
        indexing_config_with_semantic
    )`
- `def test_scenario_php_project_readme_generation(self, temp_dir)`

**Functions:**
- `def temp_dir(tmp_path)`

### test_story_4_4_integration.py
_Integration tests for Story 4.4: Business Semantic Extraction

Tests the complete workflow:
1. SemanticExtractor extracts business semantics
2. SmartW_

**class** `class TestStory44EndToEnd`
> End-to-end integration tests for Story 4.4

**class** `class TestStory44PerformanceValidation`
> Performance validation for Story 4.4

**Methods:**
- `def test_semantic_extractor_on_auth_module(self, test_project)`
- `def test_semantic_extractor_on_api_module(self, test_project)`
- `def test_smart_writer_uses_semantic_extraction(self, test_project)`
- `def test_project_index_generation_workflow(self, test_project)`
- `def test_backward_compatibility_without_semantic(self, test_project)`
- `def test_semantic_extraction_performance(self)`
- `def test_extract_module_purpose_performance(self, tmp_path)`

### test_super_large_detection_bdd.py
_BDD tests for super large file detection (Epic 3.2 Story 3.2.1)._

**Functions:**
- `def load_config()`
- `def symbol_scorer_available()`
- `def file_with_lines(language, lines)`
- `def file_with_symbols(test_file, count)`
- `def project_with_files(datatable)`
- `def custom_thresholds_configured(config, datatable)`
- `def check_super_large_file(test_file, config)`
- `def select_strategies(project_files, config)`
- `def should_be_super_large(detection_result)`
- `def should_not_be_super_large(detection_result)`
- `def detection_reason_is(detection_result, reason)`
- `def recommend_multi_turn_dialogue(detection_result)`
- `def recommend_standard_enhancement(detection_result)`
- `def recommend_hierarchical_strategy(detection_result)`
- `def verify_expected_strategies(project_files, strategy_results)`

_... and 2 more symbols_

### test_symbol_overload.py
_Tests for symbol overload detection._

**class** `class TestSymbolOverloadAnalysis`
> Test SymbolOverloadAnalysis dataclass.

**class** `class TestSymbolCountDetection`
> Test massive symbol count detection.

**class** `class TestNoiseRatioDetection`
> Test high noise ratio detection.

**class** `class TestNoiseBreakdown`
> Test noise breakdown analysis.

**class** `class TestIntegration`
> Integration tests for symbol overload detection.

**Methods:**
- `def test_create_symbol_overload_analysis(self)`
- `def test_analysis_with_no_noise(self)`
- `def test_detect_massive_symbol_count(self, mock_config, symbol_scorer)`
- `def test_normal_symbol_count_no_issue(self, mock_config, symbol_scorer)`
- `def test_symbol_count_at_boundary(self, mock_config, symbol_scorer)`
- `def test_symbol_count_just_over_boundary(self, mock_config, symbol_scorer)`
- `def test_detect_high_noise_ratio(self, mock_config, symbol_scorer)`
- `def test_low_noise_no_issue(self, mock_config, symbol_scorer)`
- `def test_noise_breakdown_categorization(self, mock_config, symbol_scorer)`
- `def test_real_world_scenario(self, mock_config, symbol_scorer)`

### test_symbol_scorer.py
_Tests for symbol importance scorer._

**class** `class TestSymbolScorerBase`
> 测试符号评分器基础功能

**class** `class TestVisibilityScoring`
> 测试可见性评分

**class** `class TestSemanticScoring`
> 测试语义重要性评分

**class** `class TestDocumentationScoring`
> 测试文档质量评分

**Methods:**
- `def test_scorer_initialization_without_context(self)`
- `def test_scorer_initialization_with_context(self)`
- `def test_score_returns_valid_range(self)`
- `def test_score_is_consistent(self)`
- `def test_different_symbols_different_scores(self)`
- `def test_php_public_method_high_score(self, scorer)`
- `def test_php_protected_method_medium_score(self, scorer)`
- `def test_python_public_function_high_score(self, scorer)`
- `def test_python_magic_method_low_score(self, scorer)`
- `def test_generic_method_low_score(self, scorer)`
- `def test_case_insensitive_matching(self, scorer)`

_... and 18 more symbols_

### test_tech_debt_bdd.py
_BDD tests for technical debt detection using pytest-bdd._

**Functions:**
- `def tech_debt_detector_fixture()`
- `def symbol_scorer_fixture()`
- `def file_with_lines(lines, language)`
- `def well_structured_symbols(file_data, count)`
- `def symbols(file_data, count)`
- `def class_with_methods(file_data, class_name, method_count)`
- `def analyze_debt(file_data, tech_debt_detector, symbol_scorer)`
- `def no_critical_issues(analysis_result)`
- `def no_high_issues(analysis_result)`
- `def quality_score_above_80(analysis_result)`
- `def report_critical_issue(request)`
- `def report_high_issue(analysis_result)`
- `def issue_category(request, category)`
- `def issue_description_includes(analysis_result, text)`
- `def issue_description_mentions(analysis_result, text)`

_... and 29 more symbols_

### test_tech_debt_detector.py
_Tests for technical debt detection._

**class** `class TestDebtSeverity`
> Test DebtSeverity enum.

**class** `class TestDebtIssue`
> Test DebtIssue dataclass.

**class** `class TestDebtAnalysisResult`
> Test DebtAnalysisResult dataclass.

**class** `class TestTechDebtDetector`
> Test TechDebtDetector class.

**class** `class TestFileSizeDetection`
> Test file size detection functionality.

**Methods:**
- `def test_severity_levels_exist(self)`
- `def test_severity_ordering(self)`
- `def test_create_debt_issue(self)`
- `def test_create_analysis_result(self)`
- `def test_analysis_result_with_no_issues(self)`
- `def test_create_detector(self, mock_config)`
- `def test_detector_has_thresholds(self, mock_config)`
- `def test_detect_super_large_file(self, mock_config, symbol_scorer)`
- `def test_super_large_file_has_split_suggestion(self, mock_config, symbol_scorer)`
- `def test_detect_large_file(self, mock_config, symbol_scorer)`

_... and 22 more symbols_

### test_tech_debt_formatters.py
_Tests for technical debt report formatters._

**class** `class TestConsoleFormatter`
> Test ConsoleFormatter.

**class** `class TestMarkdownFormatter`
> Test MarkdownFormatter.

**class** `class TestJSONFormatter`
> Test JSONFormatter.

**Methods:**
- `def test_format_empty_report(self)`
- `def test_format_report_with_single_file(self)`
- `def test_format_includes_severity_counts(self)`
- `def test_format_empty_report(self)`
- `def test_format_report_with_issues(self)`
- `def test_format_uses_markdown_tables(self)`
- `def test_format_empty_report(self)`
- `def test_format_report_with_issues(self)`
- `def test_json_is_valid_format(self)`

### test_tech_debt_reporter.py
_Tests for technical debt reporting._

**class** `class TestFileReport`
> Test FileReport dataclass.

**class** `class TestTechDebtReport`
> Test TechDebtReport dataclass.

**class** `class TestTechDebtReporter`
> Test TechDebtReporter class.

**Methods:**
- `def test_create_file_report_with_debt_analysis(self)`
- `def test_create_file_report_with_symbol_analysis(self)`
- `def test_file_report_counts_issues(self)`
- `def test_create_empty_report(self)`
- `def test_create_report_with_one_file(self)`
- `def test_create_report_with_multiple_files(self)`
- `def test_create_reporter(self)`
- `def test_add_single_file_result(self)`
- `def test_add_multiple_file_results(self)`
- `def test_generate_report_for_empty_reporter(self)`
- `def test_generate_report_for_single_file(self)`
- `def test_generate_report_for_multiple_files(self)`

_... and 1 more symbols_

### test_thinkphp_route_extractor.py
_Tests for ThinkPHP route extraction with line numbers (Epic 6, P1, Task 1.2)._

**class** `class TestThinkPHPRouteLineNumbers`
> Test ThinkPHP route extraction includes line numbers.

**Methods:**
- `def test_extract_routes_with_line_numbers(self)`
- `def test_extract_routes_multiple_controllers(self)`
- `def test_extract_routes_only_public_methods(self)`
- `def test_extract_routes_skip_magic_methods(self)`
- `def test_extract_routes_no_controller_class(self)`
- `def test_extract_routes_with_parse_error(self)`

## Dependencies

- .conftest
- click.testing
- codeindex.adaptive_config
- codeindex.adaptive_selector
- codeindex.cli
- codeindex.cli_symbols
- codeindex.config
- codeindex.directory_tree
- codeindex.framework_detect
- codeindex.parser
- codeindex.semantic_extractor
- codeindex.smart_writer
- codeindex.symbol_scorer
- codeindex.tech_debt
- codeindex.tech_debt_formatters
- json
- pathlib
- pytest
- pytest_bdd
- tempfile
- yaml


**Commit `16e9158`**: feat(epic6): add route table display formatting with line numbers

Changed files:
- `test_route_table_display.py`


**Commit `6a8d3ae`**: feat(epic6): add RouteExtractor abstract base class

Changed files:
- `test_route_extractor.py`


**Commit `7577104`**: feat(epic6): add RouteExtractorRegistry

Changed files:
- `test_route_registry.py`


**Commit `5aa81e0`**: feat(epic6): integrate route registry into SmartWriter

Changed files:
- `test_backward_compatibility.py`


**Commit `6086b72`**: test(epic6): add backward compatibility verification

Changed files:

---

## Recent Changes

**Commit `4331cb8`**: feat(epic6): enhance parser to extract PHP PHPDoc comments

Changed files:
- `test_php_comment_extraction.py`
