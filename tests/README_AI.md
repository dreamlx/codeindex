<!-- Generated by codeindex at 2026-01-26T09:20:49+08:00 -->

# README_AI.md - tests

## Purpose
Test suite for the codeindex package, providing comprehensive unit tests for core components including directory tree building, code parsing, smart writing functionality, and symbol importance scoring with visibility-based ranking.

## Architecture
The test suite is organized into four main test modules that mirror the core components of the codeindex package:
- `test_directory_tree.py` validates directory structure traversal and tree building
- `test_parser.py` verifies code parsing capabilities for Python and PHP
- `test_smart_writer.py` tests intelligent README generation with different detail levels
- `test_symbol_scorer.py` validates symbol importance scoring with contextual awareness and visibility scoring across languages

## Key Components
- `_create_test_structure()`: Creates temporary directory structures for testing
- `test_directory_tree_*`: Validates DirectoryTree class functionality including level determination, children management, and processing order
- `test_parse_*()`: Tests parsing of functions, classes, PHP syntax features, and error handling
- `test_smart_writer_*()`: Verifies README generation at different detail levels, file grouping, and size limits
- `TestSymbolScorerBase`: Tests symbol scorer initialization, scoring consistency, and score differentiation
- `TestVisibilityScoring`: Validates visibility-based scoring for PHP (public/protected/private) and Python (public/private/magic methods)
- `_create_mock_parse_result()`: Helper for creating mock parsing results

## Consumes
| Module | Purpose |
|--------|---------|
| codeindex.config | Config, GroupingConfig, IndexingConfig, SymbolsConfig |
| codeindex.directory_tree | DirectoryTree class for structure validation |
| codeindex.parser | ParseResult, Symbol, Import classes and parse_file function |
| codeindex.smart_writer | SmartWriter class and determine_level function |
| codeindex.symbol_scorer | SymbolImportanceScorer, ScoringContext for importance ranking |
| pytest | Test fixtures and utilities |

## Provides
| Export | Purpose |
|--------|---------|
| Test cases | Validates core package functionality |
| Test utilities | Helper functions for creating test data and structures |
| Visibility scoring tests | Validates language-specific visibility scoring rules |

## Test Coverage
- Directory tree building and traversal logic
- Code parsing for Python and PHP languages
- Multi-level README generation
- File grouping and symbol filtering
- Symbol importance scoring with context awareness
- Visibility-based scoring (PHP: public=20, protected=10, private=0; Python: public=15, private/magic=5)
- Scorer initialization and consistency
- Score range validation (0-100)
- Error handling and edge cases
- Size limit enforcement
